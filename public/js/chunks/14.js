webpackJsonp([14],{2157:function(t,a,s){var e=s(0)(s(2197),s(2198),!1,null,null,null);t.exports=e.exports},2197:function(t,a,s){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var e,n=s(10),i=(e=n)&&e.__esModule?e:{default:e},r=s(50),o=s(51);function d(t){return function(){var a=t.apply(this,arguments);return new Promise(function(t,s){return function e(n,i){try{var r=a[n](i),o=r.value}catch(t){return void s(t)}if(!r.done)return Promise.resolve(o).then(function(t){e("next",t)},function(t){e("throw",t)});t(o)}("next")})}}a.default={name:"GmfPagesAuthPassword",props:{},mixins:[r.validationMixin],data:function(){return{mainDatas:{},loading:0,sending:!1}},validations:{mainDatas:{password:{required:o.required,minLength:(0,o.minLength)(6),maxLength:(0,o.maxLength)(30)},password_confirmation:{sameAsPassword:(0,o.sameAs)("password")}}},computed:{routeQuery:function(){var t={};return this.$route.query&&this.$route.query.continue&&(t.continue=this.$route.query.continue),t}},methods:{getValidationClass:function(t){var a=this.$v.mainDatas[t];if(a)return{"md-invalid":a.$invalid&&a.$dirty}},validateForm:function(){this.$v.$touch(),this.$v.$invalid||this.submitPost()},submitPost:function(){var t=d(i.default.mark(function t(){var a;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.sending=!0,this.mainDatas.token=this.$route.params.token,t.next=5,this.$http.post("sys/auth/reset",this.mainDatas);case 5:return a=t.sent,this.sending=!1,this.$setConfigs({user:a.data.data,token:a.data.token}),t.next=10,this.$root.$loadConfigs();case 10:this.$go(this.$route.query.continue?this.$route.query.continue:this.$root.configs.home),t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),this.sending=!1,this.$toast(t.t0);case 17:case"end":return t.stop()}},t,this,[[0,13]])}));return function(){return t.apply(this,arguments)}}(),fetchData:function(){var t=d(i.default.mark(function t(){var a,s,e;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.sending=!0,(a=this.$route.params.id)||this.$go({name:"auth.chooser",query:this.routeQuery}),t.next=6,this.$http.post("sys/auth/checker",{id:a});case 6:return s=t.sent,s.data.data,this.mainDatas=s.data.data,e={id:this.mainDatas.id,type:"password",token:this.$route.params.token},t.next=12,this.$http.post("sys/auth/vcode-checker",e);case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(0),this.$toast(t.t0),this.$go({name:"auth.identifier",query:this.routeQuery});case 18:return t.prev=18,this.sending=!1,t.finish(18);case 21:case"end":return t.stop()}},t,this,[[0,14,18,21]])}));return function(){return t.apply(this,arguments)}}()},mounted:function(){var t=d(i.default.mark(function t(){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.fetchData();case 2:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},2198:function(t,a){t.exports={render:function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("md-card",[s("form",{attrs:{novalidate:""},on:{submit:function(a){return a.preventDefault(),t.validateForm(a)}}},[s("md-card-header",[s("md-card-header-text",[s("div",{staticClass:"md-title"},[t._v("重置密码")])])],1),t._v(" "),s("md-list",[s("md-list-item",[s("md-avatar",[s("md-image",{attrs:{"md-src":t.mainDatas.avatar}})],1),t._v(" "),s("div",{staticClass:"md-list-item-text"},[s("span",[t._v(t._s(t.mainDatas.name))]),t._v(" "),s("span",[t._v(t._s(t.mainDatas.account))])]),t._v(" "),s("md-button",{staticClass:"md-icon-button md-list-action",attrs:{to:{name:"auth.chooser",query:t.routeQuery}}},[s("md-icon",{staticClass:"md-primary"},[t._v("expand_more")])],1)],1)],1),t._v(" "),s("md-card-content",[s("md-layout",[s("md-field",{class:t.getValidationClass("password")},[s("label",[t._v("输入您的新密码")]),t._v(" "),s("md-input",{attrs:{autocomplete:"off",type:"password",disabled:t.sending},model:{value:t.mainDatas.password,callback:function(a){t.$set(t.mainDatas,"password",a)},expression:"mainDatas.password"}}),t._v(" "),t.$v.mainDatas.password.required?t._e():s("span",{staticClass:"md-error"},[t._v("请输入密码")])],1)],1),t._v(" "),s("md-layout",[s("md-field",{class:t.getValidationClass("password_confirmation")},[s("label",[t._v("确认密码")]),t._v(" "),s("md-input",{attrs:{autocomplete:"off",type:"password",disabled:t.sending},model:{value:t.mainDatas.password_confirmation,callback:function(a){t.$set(t.mainDatas,"password_confirmation",a)},expression:"mainDatas.password_confirmation"}}),t._v(" "),t.$v.mainDatas.password_confirmation.sameAsPassword?t._e():s("span",{staticClass:"md-error"},[t._v("确认密码不符合要求")])],1)],1)],1),t._v(" "),s("md-card-actions",[s("span",{staticClass:"flex"}),t._v(" "),s("md-button",{staticClass:"md-primary md-raised",attrs:{type:"submit",disabled:t.sending}},[t._v("设置")])],1),t._v(" "),t.sending?s("md-progress-bar",{attrs:{"md-mode":"indeterminate"}}):t._e()],1)])},staticRenderFns:[]}}});